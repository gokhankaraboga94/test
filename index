<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teknik Servis Cihaz Takip Sistemi</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <!-- ORIGINAL: <style> -->
  <link rel="stylesheet" href="style.css"> <!-- ORIGINAL: </style> -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

</head>
<body>
  <!-- TOAST CONTAINER -->
  <div class="toast-container" id="toastContainer"></div> 

  <!-- Ä°NTERNET BAÄLANTISI UYARISI -->
  <div id="connectionWarning" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); z-index: 99999; justify-content: center; align-items: center; flex-direction: column;">
    <div id="connectionWarningBox" style="background: linear-gradient(135deg, #e74c3c, #c0392b); padding: 40px 60px; border-radius: 20px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.5); max-width: 600px; animation: pulse 2s infinite;">
      <div id="connectionIcon" style="font-size: 80px; margin-bottom: 20px;">ğŸ“¡âŒ</div>
      <h1 id="connectionTitle" style="font-size: 32px; margin-bottom: 15px; color: #fff;">Ä°NTERNET BAÄLANTISI KESÄ°LDÄ°!</h1>
      <p id="connectionMessage" style="font-size: 18px; margin-bottom: 20px; color: #ecf0f1;">
        Database baÄŸlantÄ±sÄ± kurulamadÄ±.<br>
        <strong>LÃ¼tfen sistemi kullanmayÄ±n!</strong><br>
        GirdiÄŸiniz veriler kaydedilmeyecektir.
      </p>
      <div id="connectionStatus" style="font-size: 16px; color: #f39c12; margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
        ğŸ”„ BaÄŸlantÄ± kontrol ediliyor...
      </div>
    </div>
  </div>

  <div class="conflict-notification" id="conflictNotification" onclick="openSyncModalFromNotification()">
  <div class="conflict-notification-header">
    âš ï¸ Ã‡akÄ±ÅŸma Tespit Edildi!
  </div>
  <div class="conflict-notification-body">
    <span class="conflict-notification-count" id="conflictCount">0</span> adet liste Ã§akÄ±ÅŸmasÄ± bulundu.
    <br><strong>TÄ±klayarak dÃ¼zeltin â†’</strong>
  </div>
</div>

<!-- DATA SYNC VERIFICATION NOTIFICATION (SADECE ADMIN) -->
<div class="data-sync-notification" id="dataSyncNotification" onclick="openDataSyncModal()">
  <div class="data-sync-notification-header">
    ğŸ”„ Veri UyumsuzluÄŸu Tespit Edildi!
  </div>
  <div class="data-sync-notification-body">
    <span class="data-sync-notification-count" id="dataSyncCount">0</span> adet uyumsuzluk bulundu.
    <br><strong>TÄ±klayarak inceleyin ve dÃ¼zeltin â†’</strong>
  </div>
</div>

<!-- ADMIN NAV BAR -->
<div class="admin-nav" id="adminNav">
  <div class="nav-title">Mobilfon Teknik Servis Cihaz Takip Sistemi</div>
  <div class="nav-content">
    <!-- MEVCUT BUTONLAR -->
    <div class="nav-buttons">
      <button onclick="showMainView()" id="mainViewBtn">ğŸ  Ana Sayfa</button>
      <button onclick="showReportsView()" id="reportsBtn">ğŸ“Š Raporlar</button>
      <button onclick="openPriceList()" id="priceListBtn">ğŸ’° Fiyat Listesi Sistemi</button>
      <button onclick="openAccounting()" id="accountingBtn">ğŸ“’ Muhasebe Sistemi</button>
      <button onclick="showUserManagement()" id="userManagementBtn" style="display: none;">ğŸ‘¥ KullanÄ±cÄ± YÃ¶netimi</button>
      
    </div>
    
    <!-- MEVCUT NAV-BUTTONS DIV'Ä°NDEN SONRA, NAV-SEARCH'TEN Ã–NCE -->
<button onclick="openResetDashboardModal()" id="resetDashboardBtn" style="display: none; padding: 10px 15px; background: #e74c3c; color: white; border: none; border-radius: 8px; font-size: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
    ğŸ”„ Dashboard SÄ±fÄ±rla
</button>

    <!-- YENÄ° EKLENEN ARAMA ALANI -->
    <div class="nav-search">
      <input type="text" id="navSearchInput" placeholder="ğŸ” Barkod ara..." maxlength="15">
      <div id="navSearchResult" class="nav-search-result"></div>
    </div>
    
    <!-- MEVCUT USER INFO -->
    <div class="nav-user-info" id="navUserInfo" style="display: none;">
      <span class="nav-user-name" id="navUserName">ğŸ‘¤ KullanÄ±cÄ±</span>
      <button class="nav-logout-button" id="navLogoutButton">Ã‡Ä±kÄ±ÅŸ</button>
    </div>
  </div>
</div>




<!-- REPORTS MODAL -->
<div class="reports-modal" id="reportsModal">
  <div class="reports-content">
    <div class="reports-header">
      <h2>ğŸ“Š GÃ¼nlÃ¼k Raporlar</h2>
      <!-- close-reports butonunu gÃ¼ncelleyin -->
      <button class="close-reports" onclick="closeReportsModalWithoutNavigation()">âœ•</button>
    </div>
    
<div class="report-filters">
  <div class="filter-group">
    <label>ğŸ“… BaÅŸlangÄ±Ã§ Tarihi</label>
    <input type="date" id="reportStartDate">
  </div>
  
  <div class="filter-group">
    <label>ğŸ“… BitiÅŸ Tarihi</label>
    <input type="date" id="reportEndDate">
  </div>
      
      <div class="filter-group">
        <label>ğŸ“‹ Liste SeÃ§in</label>
        <select id="reportList">
 <option value="">TÃ¼mÃ¼</option>
  <option value="partOrders">ğŸ”§ Teknisyen Adetleri/ParÃ§a Ä°stekleri</option>
  <option value="atanacak">ğŸ“‹ Atanacak</option>
  <option value="parcaBekliyor">âš™ï¸ ParÃ§a Bekliyor</option>
  <option value="phonecheck">ğŸ“± PhoneCheck</option>
  <option value="gokhan">ğŸ§‘â€ğŸ”§ GÃ¶khan</option>
  <option value="enes">ğŸ§‘â€ğŸ”§ Enes</option>
  <option value="yusuf">ğŸ§‘â€ğŸ”§ Yusuf</option>
  <option value="samet">ğŸ§‘â€ğŸ”§ Samet</option>

  <option value="engin">ğŸ§‘â€ğŸ”§ Engin</option>
  <option value="ismail">ğŸ§‘â€ğŸ”§ Ä°smail</option>
  <option value="mehmet">ğŸ§‘â€ğŸ”§ Mehmet</option>
  <option value="onarim">ğŸ”§ OnarÄ±m TamamlandÄ±</option>
  <option value="onCamDisServis">ğŸ”¨ Ã–n Cam DÄ±ÅŸ Servis</option>      <!-- YENÄ° EKLENDÄ° -->
  <option value="anakartDisServis">ğŸ”¨ Anakart DÄ±ÅŸ Servis</option>  <!-- YENÄ° EKLENDÄ° -->
  <option value="satisa">ğŸ’° SatÄ±ÅŸa Gidecek</option>
  <option value="SonKullanÄ±cÄ±">SonKullanÄ±cÄ±</option>
  <option value="sahiniden">ğŸª Sahibinden</option>
  <option value="mediaMarkt">ğŸ›’ Media Markt</option>
  <option value="teslimEdilenler">âœ… Teslim Edilenler</option>
   <option value="serviceReturn">ğŸ”„ Servise Geri DÃ¶nenler</option>
    <option value="dailyReceived">ğŸ“¥ BugÃ¼n Teslim AlÄ±nan</option>
        </select>
      </div>
    </div>

    <!-- Bu butonu report-filters'Ä±n hemen altÄ±na ekleyin -->
<button class="clear-filters-btn" onclick="clearDetailFilters()" style="display: none;" id="clearFiltersBtn">
  ğŸ—‘ï¸ Filtreleri Temizle
</button>
    
    <button class="generate-report-btn" onclick="generateReport()">
      ğŸ“Š Rapor OluÅŸtur
    </button>

    <button class="export-excel-btn" onclick="exportToExcel()" id="exportExcelBtn" disabled>
  ğŸ“Š Excel'e Aktar
</button>
    
    <div class="report-results" id="reportResults">
      <!-- Results will be displayed here -->
    </div>
  </div>
</div>

  <!-- MODAL FOR USER MANAGEMENT (ADD) -->
  <div class="modal-overlay" id="addUserModal">
    <div class="modal">
      <h2>â• Yeni KullanÄ±cÄ± Ekle</h2>
      <input type="email" id="newUserEmail" class="modal-input" placeholder="E-posta adresi (Ã¶rn: ahmet@servis.com)">
      <input type="password" id="newUserPassword" class="modal-input" placeholder="Åifre (min. 6 karakter)">
      <select id="newUserRole" class="modal-input" onchange="handleRoleChange()">
        <option value="viewer">ğŸ‘ï¸ GÃ¶rÃ¼ntÃ¼leyici (Viewer)</option>
        <option value="editor">âœï¸ DÃ¼zenleyici (Editor)</option>
        <option value="semi-admin">ğŸ‘” YarÄ± Admin (Semi-Admin)</option>
        <option value="technician">ğŸ”§ Teknisyen (Technician)</option>
        <option value="warehouse">ğŸ“¦ Depocu (Warehouse)</option>
      </select>
      
      <!-- Teknisyen Ä°zinleri -->
      <div id="technicianPermissions" style="display: none;">
        <h3 style="margin: 15px 0 10px 0; font-size: 16px;">ğŸ”‘ Teknisyen Ä°zinleri</h3>
        <div class="permissions-grid" id="permissionsGrid"></div>
      </div>
      
      <div class="modal-buttons">
        <button class="modal-button secondary" onclick="closeAddUserModal()">Ä°ptal</button>
        <button class="modal-button primary" onclick="addNewUser()">KullanÄ±cÄ± Ekle</button>
      </div>
    </div>
  </div>

  <!-- MODAL FOR USER MANAGEMENT (EDIT) -->
  <div class="modal-overlay" id="editUserModal">
    <div class="modal">
      <h2>âœï¸ KullanÄ±cÄ± DÃ¼zenle</h2>
      <div style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
        <strong>Email:</strong> <span id="editUserEmail"></span>
      </div>
      <select id="editUserRole" class="modal-input" onchange="handleEditRoleChange()">
        <option value="viewer">ğŸ‘ï¸ GÃ¶rÃ¼ntÃ¼leyici (Viewer)</option>
        <option value="editor">âœï¸ DÃ¼zenleyici (Editor)</option>
        <option value="semi-admin">ğŸ‘” YarÄ± Admin (Semi-Admin)</option>
        <option value="technician">ğŸ”§ Teknisyen (Technician)</option>
        <option value="warehouse">ğŸ“¦ Depocu (Warehouse)</option>
      </select>
      
      <!-- Teknisyen Ä°zinleri -->
      <div id="editTechnicianPermissions" style="display: none;">
        <h3 style="margin: 15px 0 10px 0; font-size: 16px;">ğŸ”‘ Teknisyen Ä°zinleri</h3>
        <div class="permissions-grid" id="editPermissionsGrid"></div>
      </div>
      
      <div class="modal-buttons">
        <button class="modal-button secondary" onclick="closeEditUserModal()">Ä°ptal</button>
        <button class="modal-button primary" onclick="saveEditedUser()">Kaydet</button>
      </div>
    </div>
  </div>

  <!-- MODAL FOR EDIT BARCODE -->
  <div class="modal-overlay" id="editBarcodeModal">
    <div class="modal">
      <h2>âœï¸ Barkod DÃ¼zenle</h2>
      <input type="text" id="editBarcodeInput" class="modal-input" placeholder="Yeni barkod (15 haneli)" maxlength="15">
      <div class="modal-buttons">
        <button class="modal-button secondary" onclick="closeEditBarcodeModal()">Ä°ptal</button>
        <button class="modal-button primary" onclick="saveEditedBarcode()">Kaydet</button>
      </div>
    </div>
  </div>

  <!-- MODAL FOR PART ORDER (TECHNICIAN) -->
  <div class="modal-overlay" id="partOrderModal">
    <div class="modal">
      <h2>ğŸ”§ ParÃ§a SipariÅŸ Et</h2>
      <div class="part-order-form">
        <div>
          <label>15 Haneli Barkod:</label>
          <input type="text" id="partOrderBarcode" class="modal-input" placeholder="Ã–rn: 123456789012345" maxlength="15">
        </div>
        
        <div>
          <label>Cihaz Modeli:</label>
          <select id="partOrderModel" class="modal-input">
            <option value="">-- Model SeÃ§iniz --</option>
            <option value="Ä°PHONE 11">Ä°PHONE 11</option>
            <option value="Ä°PHONE 11 PRO">Ä°PHONE 11 PRO</option>
            <option value="Ä°PHONE 11 PRO MAX">Ä°PHONE 11 PRO MAX</option>
            <option value="Ä°PHONE 12">Ä°PHONE 12</option>
            <option value="Ä°PHONE 12 MÄ°NÄ°">Ä°PHONE 12 MÄ°NÄ°</option>
            <option value="Ä°PHONE 12 PRO">Ä°PHONE 12 PRO</option>
            <option value="Ä°PHONE 12 PROMAX">Ä°PHONE 12 PROMAX</option>
            <option value="Ä°PHONE 13">Ä°PHONE 13</option>
            <option value="Ä°PHONE 13 MÄ°NÄ°">Ä°PHONE 13 MÄ°NÄ°</option>
            <option value="Ä°PHONE 13 PRO">Ä°PHONE 13 PRO</option>
            <option value="Ä°PHONE 13 PROMAX">Ä°PHONE 13 PROMAX</option>
            <option value="Ä°PHONE 14">Ä°PHONE 14</option>
            <option value="Ä°PHONE 14 PLUS">Ä°PHONE 14 PLUS</option>
            <option value="Ä°PHONE 14 PRO">Ä°PHONE 14 PRO</option>
            <option value="Ä°PHONE 14 PROMAX">Ä°PHONE 14 PROMAX</option>
            <option value="Ä°PHONE 15">Ä°PHONE 15</option>
            <option value="Ä°PHONE 15 PLUS">Ä°PHONE 15 PLUS</option>
            <option value="Ä°PHONE 15 PRO">Ä°PHONE 15 PRO</option>
            <option value="Ä°PHONE 15 PROMAX">Ä°PHONE 15 PROMAX</option>
            <option value="Ä°PHONE 16">Ä°PHONE 16</option>
            <option value="Ä°PHONE 16 PRO">Ä°PHONE 16 PRO</option>
            <option value="Ä°PHONE 16 PROMAX">Ä°PHONE 16 PROMAX</option>
            <option value="Ä°PHONE X">Ä°PHONE X</option>
            <option value="Ä°PHONE XR">Ä°PHONE XR</option>
            <option value="Ä°PHONE XS">Ä°PHONE XS</option>
            <option value="Ä°PHONE XS MAX">Ä°PHONE XS MAX</option>
            <option value="Ä°PHONE 8 PLUS">Ä°PHONE 8 PLUS</option>
            <option value="Ä°PHONE SE 2020">Ä°PHONE SE 2020</option>
            <option value="LG">LG</option>
            <option value="MÄ° 10 LÄ°TE">MÄ° 10 LÄ°TE</option>
            <option value="REALME C21">REALME C21</option>
            <option value="REDMÄ° 12">REDMÄ° 12</option>
            <option value="REDMÄ° 12PRO">REDMÄ° 12PRO</option>
            <option value="REDMÄ° 13">REDMÄ° 13</option>
            <option value="SAMSUNG A03">SAMSUNG A03</option>
            <option value="SAMSUNG A06">SAMSUNG A06</option>
            <option value="SAMSUNG A12">SAMSUNG A12</option>
            <option value="SAMSUNG A13">SAMSUNG A13</option>
            <option value="SAMSUNG A14">SAMSUNG A14</option>
            <option value="SAMSUNG A23">SAMSUNG A23</option>
            <option value="SAMSUNG A24">SAMSUNG A24</option>
            <option value="SAMSUNG A34">SAMSUNG A34</option>
            <option value="SAMSUNG A35">SAMSUNG A35</option>
            <option value="SAMSUNG A52">SAMSUNG A52</option>
            <option value="SAMSUNG A53">SAMSUNG A53</option>
            <option value="SAMSUNG A54">SAMSUNG A54</option>
            <option value="SAMSUNG A72">SAMSUNG A72</option>
            <option value="SAMSUNG A73">SAMSUNG A73</option>
            <option value="SAMSUNG M51">SAMSUNG M51</option>
            <option value="SAMSUNG NOTE 20 ULTRA">SAMSUNG NOTE 20 ULTRA</option>
            <option value="SAMSUNG NOTE 3">SAMSUNG NOTE 3</option>
            <option value="SAMSUNG S20">SAMSUNG S20</option>
            <option value="SAMSUNG S20 FE">SAMSUNG S20 FE</option>
            <option value="SAMSUNG S20 ULTRA">SAMSUNG S20 ULTRA</option>
            <option value="SAMSUNG S21 FE">SAMSUNG S21 FE</option>
            <option value="SAMSUNG S21 PLUS">SAMSUNG S21 PLUS</option>
            <option value="SAMSUNG S21 ULTRA">SAMSUNG S21 ULTRA</option>
            <option value="SAMSUNG S22">SAMSUNG S22</option>
            <option value="SAMSUNG S22+">SAMSUNG S22+</option>
            <option value="SAMSUNG S22 ULTRA">SAMSUNG S22 ULTRA</option>
            <option value="SAMSUNG S23">SAMSUNG S23</option>
            <option value="SAMSUNG S23 PLUS">SAMSUNG S23 PLUS</option>
            <option value="SAMSUNG S23 FE">SAMSUNG S23 FE</option>
            <option value="SAMSUNG S23 ULTRA">SAMSUNG S23 ULTRA</option>
            <option value="SAMSUNG S24">SAMSUNG S24</option>
            <option value="SAMSUNG S24 PLUS">SAMSUNG S24 PLUS</option>
            <option value="SAMSUNG S24 ULTRA">SAMSUNG S24 ULTRA</option>
            <option value="OMÄ°X X400">OMÄ°X X400</option>
          </select>
        </div>
        
        <div>
          <label>MÃ¼ÅŸteri / Bayi (Ä°steÄŸe BaÄŸlÄ±):</label>
          <select id="partOrderCustomer" class="modal-input">
            <option value="">-- SeÃ§iniz (Ä°steÄŸe BaÄŸlÄ±) --</option>
            <option value="TEÅHÄ°S">TEÅHÄ°S</option>
            <option value="SAHÄ°BÄ°NDEN">SAHÄ°BÄ°NDEN</option>
            <option value="DEPO">DEPO</option>
            <option value="YENÄ°LÄ°YO">YENÄ°LÄ°YO</option>
            <option value="MEDÄ°AMARKT">MEDÄ°AMARKT</option>
            <option value="LETGO">LETGO</option>
            <option value="TURKCELL">TURKCELL</option>
            <option value="TELEKOM">TELEKOM</option>
            <option value="BAYER">BAYER</option>
            <option value="SATIÅ">SATIÅ</option>
            <option value="KALÄ°TE KONTROL">KALÄ°TE KONTROL</option>
            <option value="YÃ–NETÄ°M">YÃ–NETÄ°M</option>
            <option value="BÄ°GBOSS">BÄ°GBOSS</option>
            <option value="MUHASEBE">MUHASEBE</option>
            <option value="YAZILIM">YAZILIM</option>
            <option value="SON KULLANICI">SON KULLANICI</option>
            <option value="DIÅ SERVÄ°S">DIÅ SERVÄ°S</option>
            <option value="FÄ°RMA Ä°Ã‡Ä° Ã‡ALIÅAN">FÄ°RMA Ä°Ã‡Ä° Ã‡ALIÅAN</option>
            <option value="KARGO">KARGO</option>
            <option value="HEPSÄ°BURADA">HEPSÄ°BURADA</option>
          </select>
        </div>
        
        <div>
          <label>StatÃ¼ (Ä°steÄŸe BaÄŸlÄ±):</label>
          <select id="partOrderStatus" class="modal-input">
            <option value="">-- SeÃ§iniz (Ä°steÄŸe BaÄŸlÄ±) --</option>
            <option value="ÃœRETÄ°ME UYGUN DEÄÄ°L">ÃœRETÄ°ME UYGUN DEÄÄ°L</option>
            <option value="Ä°ADE">Ä°ADE</option>
            <option value="ÃœRETÄ°M">ÃœRETÄ°M</option>
            <option value="PARÃ‡A BEKLÄ°YOR">PARÃ‡A BEKLÄ°YOR</option>
            <option value="DIÅ SERVÄ°S">DIÅ SERVÄ°S</option>
            <option value="FÄ°YAT ONAYI">FÄ°YAT ONAYI</option>
            <option value="SERVÄ°S TEKRARI">SERVÄ°S TEKRARI</option>
            <option value="KONTROL">KONTROL</option>
            <option value="SERTÄ°FÄ°KA">SERTÄ°FÄ°KA</option>
          </select>
        </div>
        
        <div>
          <label>Hizmetler (Ä°steÄŸe BaÄŸlÄ±):</label>
          <select id="partOrderService" class="modal-input">
            <option value="">-- SeÃ§iniz (Ä°steÄŸe BaÄŸlÄ±) --</option>
            <option value="YÃœKSELTME">YÃœKSELTME</option>
            <option value="CAM SÄ°LME">CAM SÄ°LME</option>
            <option value="YAZILIM YÃœKLEME">YAZILIM YÃœKLEME</option>
            <option value="SWAP KARARI">SWAP KARARI</option>
            <option value="TEMÄ°ZLÄ°K">TEMÄ°ZLÄ°K</option>
            <option value="KASA PARLATMA">KASA PARLATMA</option>
            <option value="Ä°MEÄ° KONTROL">Ä°MEÄ° KONTROL</option>
            <option value="LEHÄ°M Ä°ÅLEM">LEHÄ°M Ä°ÅLEM</option>
            <option value="GENEL BAKIM">GENEL BAKIM</option>
            <option value="Ä°ADE DEPO">Ä°ADE DEPO</option>
            <option value="MÃœÅTERÄ° Ä°ADE">MÃœÅTERÄ° Ä°ADE</option>
            <option value="ONARIM">ONARIM</option>
            <option value="ARKA KAPAK YAPIÅTIRMA">ARKA KAPAK YAPIÅTIRMA</option>
            <option value="EKRAN BANDI YENÄ°LEME">EKRAN BANDI YENÄ°LEME</option>
          </select>
        </div>
        
        <div>
          <label>Not (Ä°steÄŸe BaÄŸlÄ±):</label>
          <textarea id="partOrderNote" class="modal-input" placeholder="Eklemek istediÄŸiniz notlar..." rows="3" style="resize: vertical;"></textarea>
        </div>
        
        <div>
          <label>Ä°stenilen ParÃ§alar (1-4 adet):</label>
          <div class="part-inputs-grid">
            <div class="part-input-group">
              <label>ParÃ§a 1:</label>
              <input type="text" id="partOrderPart1" placeholder="Ã–rn: Batarya">
            </div>
            <div class="part-input-group">
              <label>ParÃ§a 2:</label>
              <input type="text" id="partOrderPart2" placeholder="Opsiyonel">
            </div>
            <div class="part-input-group">
              <label>ParÃ§a 3:</label>
              <input type="text" id="partOrderPart3" placeholder="Opsiyonel">
            </div>
            <div class="part-input-group">
              <label>ParÃ§a 4:</label>
              <input type="text" id="partOrderPart4" placeholder="Opsiyonel">
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-buttons">
        <button class="modal-button secondary" onclick="closePartOrderModal()">Ä°ptal</button>
        <button class="modal-button primary" onclick="submitPartOrder()">Ä°stek GÃ¶nder</button>
      </div>
    </div>
  </div>

  <!-- PROFESYONEL LOGIN EKRANI -->
  <div id="loginScreen" class="login-container">
    <div class="login-box">
      <div class="login-header">
        <div class="login-icon">ğŸ”§</div>
        <h2>Mobilfon Teknik Servis GiriÅŸi</h2>
        <p>Cihaz Takip Sistemi</p>
      </div>
      <div class="login-form">
        <div class="input-group">
          <span class="input-icon">ğŸ“§</span>
          <input type="email" id="emailInput" class="login-input" placeholder="E-posta adresiniz" autocomplete="email">
        </div>
        <div class="input-group">
          <span class="input-icon">ğŸ”’</span>
          <input type="password" id="passwordInput" class="login-input" placeholder="Åifreniz" autocomplete="current-password">
        </div>
        <div id="errorMessage" class="error-message"></div>
        <button id="loginButton" class="login-button">GiriÅŸ Yap</button>
      </div>
      <div class="login-footer">
        <p>Â© 2025 Teknik Servis Sistemi</p>
      </div>
    </div>
  </div>



  <div id="appContainer" class="app-container">
  
   <!-- DASHBOARD PANEL - ADMIN PANELÄ°N HEMEN ALTINDA SABÄ°T -->
<div id="dashboardPanel" class="dashboard-panel" style="display: none;">
  <div class="dashboard-header">
    <h2>ğŸ“Š GÃ¼nlÃ¼k Dashboard</h2>
    <div class="dashboard-date" id="dashboardDate">YÃ¼kleniyor...</div>
    <button id="restoreDashboardBtn" onclick="restoreDashboard()" style="display: none; padding: 10px 18px; background: linear-gradient(135deg, #27ae60, #229954); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-left: 15px; box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);">
      â™»ï¸ Geri YÃ¼kle
    </button>
  </div>
  
  <div class="dashboard-stats">
    <div class="dashboard-stat-card">
      <span class="dashboard-stat-icon">ğŸ“¥</span>
      <div class="dashboard-stat-label">BugÃ¼n Teslim AlÄ±nan</div>
      <div class="dashboard-stat-value" id="dashboardTeslimAlinan">0</div>
    </div>
    
    <div class="dashboard-stat-card">
      <span class="dashboard-stat-icon">ğŸ“¤</span>
      <div class="dashboard-stat-label">BugÃ¼n Teslim Edilen</div>
      <div class="dashboard-stat-value" id="dashboardTeslimEdilen">0</div>
    </div>
  </div>
  
 <div class="dashboard-details">
    <h3>ğŸ“‹ Teslim AlÄ±nan Kaynak DaÄŸÄ±lÄ±mÄ±</h3>
    <div class="dashboard-detail-item">
      <span class="dashboard-detail-label">Atanacak(TeÅŸhis)</span>
      <span class="dashboard-detail-value" id="dashboardAtanacakCount">0</span>
    </div>
    <div class="dashboard-detail-item">
      <span class="dashboard-detail-label">SonKullanÄ±cÄ±</span>
      <span class="dashboard-detail-value" id="dashboardSonKullanÄ±cÄ±Count">0</span>
    </div>
    <div class="dashboard-detail-item">
      <span class="dashboard-detail-label">Sahibinden</span>
      <span class="dashboard-detail-value" id="dashboardSahibindenCount">0</span>
    </div>
    <div class="dashboard-detail-item">
      <span class="dashboard-detail-label">Media Markt</span>
      <span class="dashboard-detail-value" id="dashboardMediaMarktCount">0</span>
    </div>
    <!-- âœ… YENÄ° EKLENEN SATIR -->
    <div class="dashboard-detail-item" style="border-left: 3px solid #e67e22;">
      <span class="dashboard-detail-label">ğŸ”„ Servise Geri DÃ¶nenler</span>
      <span class="dashboard-detail-value" id="dashboardServiceReturnCount">0</span>
    </div>
  </div>
   </div>
    
    <!-- USER MANAGEMENT SECTION (ADMIN ONLY) -->
    <div id="userManagement" class="user-management" style="display: none;">
      <h2>ğŸ‘¥ KullanÄ±cÄ± YÃ¶netimi</h2>
      <div class="user-list" id="userList">
        <!-- Users will be loaded here -->
      </div>
      <button class="add-user-btn" onclick="openAddUserModal()">
        <span>â•</span>
        <span>Yeni KullanÄ±cÄ± Ekle</span>
      </button>
    </div>

    <div id="adminPanel">
      <h2>ğŸ‘‘ Admin Paneli</h2>
<div class="admin-stats">
  <div class="admin-stat-box">
    <div class="label">Servisteki Toplam Cihaz</div>
    <div id="adminTotalBarcodes" class="value">0</div>
  </div>
  <!-- EÅLEÅME ORANI VE EÅLEÅEN BARKOD SÄ°LÄ°NDÄ° -->
  <div class="admin-stat-box">
    <div class="label">Atanacak Cihazlar</div>
    <div id="adminAtanacak" class="value">0</div>
  </div>
  <div class="admin-stat-box">
    <div class="label">ParÃ§a Bekliyor</div>
    <div id="adminParcaBekliyor" class="value">0</div>
  </div>
  <div class="admin-stat-box">
    <div class="label">PhoneCheck</div>
    <div id="adminPhonecheck" class="value">0</div>
  </div>

    <div class="admin-stat-box">
    <div class="label">SonKullanÄ±cÄ±</div>
    <div id="SonKullanÄ±cÄ±" class="value">0</div>
  </div>


  <div class="admin-stat-box">
    <div class="label">OnarÄ±m TamamlandÄ±</div>
    <div id="adminOnarim" class="value">0</div>
  </div>
  <!-- YENÄ° EKLENEN DIÅ SERVÄ°SLER -->
  <div class="admin-stat-box">
    <div class="label">Ã–n Cam DÄ±ÅŸ Servis</div>
    <div id="adminOnCamDisServis" class="value">0</div>
  </div>
  <div class="admin-stat-box">
    <div class="label">Anakart DÄ±ÅŸ Servis</div>
    <div id="adminAnakartDisServis" class="value">0</div>
  </div>
  <!-- ESKÄ° DIÅ SERVÄ°S SÄ°LÄ°NDÄ° -->

  <div class="admin-stat-box">
    <div class="label">SatÄ±ÅŸa Gidecek</div>
    <div id="adminSatisa" class="value">0</div>
  </div>
  <div class="admin-stat-box">
    <div class="label">Sahibinden</div>
    <div id="adminSahiniden" class="value">0</div>
  </div>
  <div class="admin-stat-box">
    <div class="label">Media Markt</div>
    <div id="adminMediaMarkt" class="value">0</div>
  </div>

  <div class="admin-stat-box">
    <div class="label">Toplam Teknisyen CihazlarÄ±</div>
    <div id="adminTeknisyenler" class="value">0</div>
  </div>
  <div class="admin-stat-box">
    <div class="label">Teslim Edilenler</div>
    <div id="adminTeslimEdilenler" class="value">0</div>
  </div>
</div>
      
      <!-- Barkod Ara BÃ¶lÃ¼mÃ¼ Admin Panele TaÅŸÄ±ndÄ± -->
      <div style="margin-top: 25px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 12px;">
        <label for="searchInput" style="display: block; margin-bottom: 10px; font-size: 18px; font-weight: bold;">ğŸ” Barkod Ara:</label>
        <textarea id="searchInput" placeholder="Aramak istediÄŸiniz barkodu girin..." style="height: 60px; background: rgba(255,255,255,0.9); color: #333;"></textarea>
        <div id="searchResult" style="margin-top: 10px; padding: 10px; background: rgba(10, 78, 180, 0.493); border-radius: 8px; min-height: 40px; display: none; color: #fff;"></div>
        <div id="partInfoAdmin" style="display: none;"></div>
        <div id="historyLog" class="history-log" style="display: none; background: rgba(255,255,255,0.1); margin-top: 10px;"></div>
      </div>
    </div>

    <!-- WAREHOUSE PANEL (DEPOCU) -->
    <div id="warehousePanel" class="warehouse-panel" style="display: none;">
      <div class="warehouse-header">
        <h2>ğŸ“¦ Depo ParÃ§a YÃ¶netim Paneli</h2>
        <p style="opacity: 0.9; margin-top: 5px;">Bekleyen ParÃ§a Ä°steklerini YÃ¶netin</p>
        <div class="warehouse-stats">
          <div class="warehouse-stat">
            <div class="warehouse-stat-label">Bekleyen Ä°stekler</div>
            <div class="warehouse-stat-value" id="warehousePendingCount">0</div>
          </div>
          <div class="warehouse-stat">
            <div class="warehouse-stat-label">HazÄ±r Olanlar</div>
            <div class="warehouse-stat-value" id="warehouseReadyCount">0</div>
          </div>
          <div class="warehouse-stat">
            <div class="warehouse-stat-label">Toplam Ä°stekler</div>
            <div class="warehouse-stat-value" id="warehouseTotalCount">0</div>
          </div>
        </div>
        
        <!-- TOPLU HAZIR BUTONU -->
        <button id="markAllReadyBtn" class="mark-all-ready-btn" onclick="markAllOrdersReady()" style="display: none;">
          âœ… TÃ¼mÃ¼nÃ¼ HazÄ±r Ä°ÅŸaretle
        </button>
      </div>
      
      <div class="warehouse-orders" id="warehouseOrders">
        <!-- Orders will be loaded here -->
      </div>
    </div>

    <div class="main-layout" id="mainLayout">
      <div class="left-side">
        <div class="container" id="techniciansContainer">
          <div class="section" data-section="gokhan">
            <label for="gokhanInput">
              <span id="gokhanLabel">ğŸ§‘â€ğŸ”§ GÃ¶khan'Ä±n CihazlarÄ± -  0</span>
            </label>
            <textarea id="gokhanInput" placeholder="GÃ¶khan'Ä±n barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="gokhanList" class="mini-list"></div>
          </div>
          
          <div class="section" data-section="yusuf">
            <label for="yusufInput"><span id="yusufLabel">ğŸ§‘â€ğŸ”§ Yusuf'un CihazlarÄ± -  0</span></label>
            <textarea id="yusufInput" placeholder="Yusuf'un barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="yusufList" class="mini-list"></div>
          </div>
          
          <div class="section" data-section="enes">
            <label for="enesInput"><span id="enesLabel">ğŸ§‘â€ğŸ”§ Enes'in CihazlarÄ± -  0</span></label>
            <textarea id="enesInput" placeholder="Enes'in barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="enesList" class="mini-list"></div>
          </div>
          
          <div class="section" data-section="samet">
            <label for="sametInput"><span id="sametLabel">ğŸ§‘â€ğŸ”§ Samet'in CihazlarÄ± -  0</span></label>
            <textarea id="sametInput" placeholder="Samet'in barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="sametList" class="mini-list"></div>
          </div>
          

          <div class="section" data-section="engin">
            <label for="enginInput"><span id="enginLabel">ğŸ§‘â€ğŸ”§ Engin'in CihazlarÄ± -  0</span></label>
            <textarea id="enginInput" placeholder="engin'in barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="enginList" class="mini-list"></div>
          </div>
          
          <div class="section" data-section="ismail">
            <label for="ismailInput"><span id="ismailLabel">ğŸ§‘â€ğŸ”§ Ä°smail'in CihazlarÄ± -  0</span></label>
            <textarea id="ismailInput" placeholder="Ä°smail'in barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="ismailList" class="mini-list"></div>
          </div>
          
          <div class="section" data-section="mehmet">
            <label for="mehmetInput"><span id="mehmetLabel">ğŸ§‘â€ğŸ”§ Mehmet'in CihazlarÄ± -  0</span></label>
            <textarea id="mehmetInput" placeholder="Mehmet'in barkodlarÄ±nÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
            <div id="mehmetList" class="mini-list"></div>
          </div>
        </div>

<div class="container" style="margin-top: 20px;" id="scannerSection">
  <div class="section" style="flex: 1 1 100%;">
    <label for="scannerInput">ğŸ“¡ Barkod Okut:</label>
    <textarea id="scannerInput" placeholder="Barkod okuyucu ile okut..." autofocus></textarea>
  </div>
</div>


  <div class="container" style="margin-top: 20px;" id="normalSearchSection">
  <div class="section" id="normalUserSearch" style="flex: 1 1 100%; display: none;">
    <label for="searchInputNormal">ğŸ” Barkod Ara:</label>
    <textarea id="searchInputNormal" placeholder="Aramak istediÄŸiniz barkodu girin..." style="height: 60px;"></textarea>
    <div id="searchResultNormal" style="margin-top: 10px; padding: 10px; background: #444; border-radius: 8px; min-height: 40px; display: none;"></div>
    <div id="partInfoNormal" style="display: none;"></div>
    <div id="historyLogNormal" class="history-log" style="display: none; background: #ac34db;"></div>
  </div>
</div>

        <!-- TEKNÄ°SYEN PARÃ‡A SÄ°PARÄ°ÅLERÄ° BÃ–LÃœMÃœ -->
        <div id="technicianPartOrders" class="part-orders-section" style="display: none;">
          <h3>ğŸ”§ ParÃ§a Ä°steklerim</h3>
          <div id="technicianOrdersList">
            <!-- Orders will be loaded here -->
          </div>
        </div>

        <div class="container" style="margin-top: 20px;">
  <div class="section" style="flex: 1 1 100%;">
    <label for="teslimEdilenlerInput"><span id="teslimEdilenlerLabel">âœ… Teslim Edilenler -  0</span></label>
    <textarea id="teslimEdilenlerInput" placeholder="Teslim edilen barkodlar..." style="height: 120px;"></textarea>
    <div id="teslimEdilenlerList" class="mini-list"></div>  </div>
</div>

<div class="container" style="margin-top: 20px;" id="mainSectionsContainer">
  <!-- Atanacak Section -->
  <div class="section" data-section="atanacak">
    <label for="atanacakInput">
      <span id="atanacakLabel">ğŸ“‹ Atanacak -  0</span>
    </label>
    <textarea id="atanacakInput" placeholder="Atanacak cihazlar..."></textarea>
    <div id="atanacakList" class="mini-list"></div>
  </div>
  
  <!-- ParÃ§a Bekliyor Section -->
  <div class="section" data-section="parcaBekliyor">
    <label for="parcaBekliyorInput">
      <span id="parcaBekliyorLabel">âš™ï¸ ParÃ§a Bekliyor -  0</span>
    </label>
    <textarea id="parcaBekliyorInput" placeholder="ParÃ§a bekleyen cihazlar..."></textarea>
    <div id="parcaBekliyorList" class="mini-list"></div>
  </div>
  
  <!-- PhoneCheck Section -->
  <div class="section" data-section="phonecheck">
    <label for="phonecheckInput">
      <span id="phonecheckLabel">ğŸ“± PhoneCheck -  0</span>
    </label>
    <textarea id="phonecheckInput" placeholder="PhoneCheck'e transfer edilecek barkodlar..."></textarea>
    <div id="phonecheckList" class="mini-list"></div>
  </div>

  <!-- OnarÄ±m TamamlandÄ± Section -->
  <div class="section" data-section="onarim">
    <label for="onarimInput">
      <span id="onarimLabel">ğŸ”§ OnarÄ±m TamamlandÄ± -  0</span>
    </label>
    <textarea id="onarimInput" placeholder="OnarÄ±mÄ± tamamlanan cihazlar..."></textarea>
    <div id="onarimList" class="mini-list"></div>
  </div>

  <!-- Ã–n Cam DÄ±ÅŸ Servis Section -->
  <div class="section" data-section="onCamDisServis">
    <label for="onCamDisServisInput">
      <span id="onCamDisServisLabel">ğŸ”¨ Ã–n Cam DÄ±ÅŸ Servis -  0</span>
    </label>
    <textarea id="onCamDisServisInput" placeholder="Ã–n cam iÃ§in dÄ±ÅŸ servise gÃ¶nderilecek barkodlar..."></textarea>
    <div id="onCamDisServisList" class="mini-list"></div>
  </div>

  <!-- Anakart DÄ±ÅŸ Servis Section -->
  <div class="section" data-section="anakartDisServis">
    <label for="anakartDisServisInput">
      <span id="anakartDisServisLabel">ğŸ”¨ Anakart DÄ±ÅŸ Servis -  0</span>
    </label>
    <textarea id="anakartDisServisInput" placeholder="Anakart iÃ§in dÄ±ÅŸ servise gÃ¶nderilecek barkodlar..."></textarea>
    <div id="anakartDisServisList" class="mini-list"></div>
  </div>

  <!-- Son KullanÄ±cÄ± Section -->
  <div class="section" data-section="SonKullanÄ±cÄ±">
    <label for="SonKullanÄ±cÄ±Input">
      <span id="SonKullanÄ±cÄ±Label">ğŸ‘¤ Son KullanÄ±cÄ± -  0</span>
    </label>
    <textarea id="SonKullanÄ±cÄ±Input" placeholder="Son KullanÄ±cÄ± barkodlar..."></textarea>
    <div id="SonKullanÄ±cÄ±List" class="mini-list"></div>
  </div>

  <!-- SatÄ±ÅŸa Gidecek Section -->
  <div class="section" data-section="satisa">
    <label for="satisaInput">
      <span id="satisaLabel">ğŸ’° SatÄ±ÅŸa Gidecek -  0</span>
    </label>
    <textarea id="satisaInput" placeholder="SatÄ±ÅŸa gidecek barkodlar..."></textarea>
    <div id="satisaList" class="mini-list"></div>
  </div>

  <!-- Sahibinden Section -->
  <div class="section" data-section="sahiniden">
    <label for="sahinidenInput">
      <span id="sahinidenLabel">ğŸª Sahibinden -  0</span>
    </label>
    <textarea id="sahinidenInput" placeholder="Sahibinden gelen barkodlar..."></textarea>
    <div id="sahinidenList" class="mini-list"></div>
  </div>

  <!-- Media Markt Section -->
  <div class="section" data-section="mediaMarkt">
    <label for="mediaMarktInput">
      <span id="mediaMarktLabel">ğŸ›’ Media Markt -  0</span>
    </label>
    <textarea id="mediaMarktInput" placeholder="Media Markt barkodlarÄ±..."></textarea>
    <div id="mediaMarktList" class="mini-list"></div>
  </div>


</div>



    
    <!-- PARÃ‡A SÄ°PARÄ°Å BUTONU (TEKNÄ°SYENLER Ä°Ã‡Ä°N) -->
    <button id="partOrderButton" class="part-order-button" style="display: none;" onclick="openPartOrderModal()">
      ğŸ”§
    </button>
  </div>


<div class="reset-modal-overlay" id="resetDashboardModal">
  <div class="reset-modal">
    <h2>âš ï¸ Dashboard SÄ±fÄ±rlama</h2>
    <p>
      <strong>Bu iÅŸlem ÅŸunlarÄ± sÄ±fÄ±rlayacak:</strong><br><br>
      ğŸ“Š BugÃ¼n Teslim AlÄ±nan: <span id="resetTeslimAlinan">0</span><br>
      ğŸ“¤ BugÃ¼n Teslim Edilen: <span id="resetTeslimEdilen">0</span><br>
      ğŸ“‹ Kaynak DaÄŸÄ±lÄ±mÄ± (Atanacak, SonKullanÄ±cÄ±, Sahibinden, Media Markt)<br><br>
      <strong style="color: #ffd700;">âš ï¸ Bu iÅŸlem geri alÄ±namaz!</strong><br>
      Ä°ÅŸlem database'de loglanacaktÄ±r.
    </p>
    <div class="reset-modal-buttons">
      <button class="reset-modal-btn cancel" onclick="closeResetDashboardModal()">âŒ Ä°ptal</button>
      <button class="reset-modal-btn confirm" onclick="confirmResetDashboard()">âœ… SÄ±fÄ±rla</button>
    </div>
  </div>
</div>


<div class="modal-overlay" id="syncModal">
  <div class="modal" style="max-width: 700px;">
    <h2>ğŸ”„ Liste Senkronizasyonu</h2>
    <div class="sync-results" id="syncResults">
      <div style="text-align: center; padding: 20px;">
        <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p>Ã‡akÄ±ÅŸmalar taranÄ±yor...</p>
      </div>
    </div>
    <div class="modal-buttons">
      <button class="modal-button secondary" onclick="closeSyncModal()">Ä°ptal</button>
      <button class="modal-button primary" onclick="fixAllConflicts()" id="fixAllBtn" disabled>ğŸ”„ TÃ¼m Ã‡akÄ±ÅŸmalarÄ± DÃ¼zelt</button>
    </div>
  </div>
</div>

<!-- DATA SYNC VERIFICATION MODAL (SADECE ADMIN) -->
<div class="modal-overlay" id="dataSyncModal">
  <div class="modal" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
    <h2>ğŸ”„ Veri DoÄŸrulama ve Senkronizasyon</h2>
    <div class="data-sync-info" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
      <p style="margin: 0; font-size: 14px;">
        â±ï¸ <strong>Son Kontrol:</strong> <span id="lastSyncCheck">-</span><br>
        ğŸ” <strong>Kontrol AralÄ±ÄŸÄ±:</strong> Her 5 dakika<br>
        ğŸ“Š <strong>Kontrol Edilen Listeler:</strong> TÃ¼m listeler ve Dashboard verileri
      </p>
    </div>
    
    <div class="sync-results" id="dataSyncResults">
      <div style="text-align: center; padding: 20px;">
        <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p>Veriler kontrol ediliyor...</p>
      </div>
    </div>
    
    <div class="modal-buttons">
      <button class="modal-button secondary" onclick="closeDataSyncModal()">Kapat</button>
      <button class="modal-button primary" onclick="fixAllDataMismatches()" id="fixAllDataBtn" disabled>
        âœ… TÃ¼m UyumsuzluklarÄ± DÃ¼zelt
      </button>
      <button class="modal-button" onclick="forceDataSyncCheck()" style="background: #3498db;">
        ğŸ”„ Yeniden Kontrol Et
      </button>
    </div>
  </div>
</div>
<!-- ORIGINAL: <script> -->
<script src="script.js"></script> <!-- ORIGINAL: </script> -->
<script src="fiyatlar.html"></script> <!-- ORIGINAL: </script> -->

<script src="muhasebe.html"></script> <!-- ORIGINAL: </script> -->

</body>
</html>